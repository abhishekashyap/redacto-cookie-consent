!function(){"use strict";const e={google_analytics:{name:"Google Analytics",category:"analytics",patterns:[/google-analytics\.com/i,/googletagmanager\.com.*gtag/i,/gtag/i,/analytics\.js/i,/ga\.js/i],inlinePatterns:[/gtag\s*\(/i,/dataLayer/i,/GoogleAnalyticsObject/i,/_gaq/i,/GA_MEASUREMENT_ID/i],globals:["gtag","dataLayer","ga","_gaq"]},hotjar:{name:"Hotjar",category:"analytics",patterns:[/hotjar\.com/i,/static\.hotjar\.com/i],inlinePatterns:[/\.hj\s*=/i,/_hjSettings/i,/hotjar/i],globals:["hj","_hjSettings"]},mixpanel:{name:"Mixpanel",category:"analytics",patterns:[/mixpanel\.com/i,/cdn\.mxpnl\.com/i],inlinePatterns:[/mixpanel\./i,/mixpanel\.init/i],globals:["mixpanel"]},facebook_pixel:{name:"Facebook Pixel",category:"advertising",patterns:[/facebook\.net\/.*\/fbevents/i,/connect\.facebook\.net/i],inlinePatterns:[/fbq\s*\(/i,/_fbq/i,/facebook.*pixel/i],globals:["fbq","_fbq"]},google_ads:{name:"Google Ads",category:"advertising",patterns:[/doubleclick\.net/i,/googlesyndication\.com/i,/ads\.google\.com/i,/googleadservices\.com/i,/googletagmanager\.com\/gtm/i],inlinePatterns:[/google_conversion/i,/google_trackConversion/i,/google_tag_manager/i,/GTM-/i],globals:["google_trackConversion","google_tag_manager"]},twitter:{name:"Twitter/X Pixel",category:"advertising",patterns:[/platform\.twitter\.com/i,/analytics\.twitter\.com/i],inlinePatterns:[/twttr/i,/twitter.*pixel/i],globals:["twttr"]},linkedin:{name:"LinkedIn Insight",category:"advertising",patterns:[/platform\.linkedin\.com/i,/snap\.licdn\.com/i],inlinePatterns:[/linkedin.*insight/i,/_linkedin_data_partner_id/i],globals:["IN"]}},t={analytics:{name:"Analytics Cookies",description:"Help us understand how visitors interact with our website",required:!1,services:[]},advertising:{name:"Advertising Cookies",description:"Used to track visitors across websites for advertising purposes",required:!1,services:[]}};Object.entries(e).forEach(([e,o])=>{t[o.category]&&t[o.category].services.push(e)});const o={storageKey:"redacto_consent",cookieName:"redacto_consent",cookieExpiryDays:365,useLocalStorage:!0,useCookies:!0,apiEnabled:!0,organisationUuid:null,workspaceUuid:null,domainUrl:null},n={initialized:!1,consent:{strictly_necessary:!0,analytics:!1,advertising:!1},blockedScripts:[],blockedInlineScripts:[],observer:null};function c(e){!function(e){if(o.useLocalStorage)try{const t={consent:e,timestamp:Date.now(),version:"0.0.1"};localStorage.setItem(o.storageKey,JSON.stringify(t)),console.log("[Redacto] üíæ Consent saved to localStorage:",e)}catch(e){console.warn("[Redacto] ‚ö†Ô∏è Failed to save to localStorage:",e)}}(e),function(e,t,n){if(o.useCookies)try{const o=new Date;o.setTime(o.getTime()+24*n*60*60*1e3);const c=encodeURIComponent(JSON.stringify(t));document.cookie=`${e}=${c};expires=${o.toUTCString()};path=/;SameSite=Lax`,console.log("[Redacto] üç™ Consent saved to cookie:",t)}catch(e){console.warn("[Redacto] ‚ö†Ô∏è Failed to save to cookie:",e)}}(o.cookieName,e,o.cookieExpiryDays)}function r(){let e=function(){if(!o.useLocalStorage)return null;try{const e=localStorage.getItem(o.storageKey);if(e){const t=JSON.parse(e);return console.log("[Redacto] üìñ Consent loaded from localStorage:",t.consent),t.consent}}catch(e){console.warn("[Redacto] ‚ö†Ô∏è Failed to load from localStorage:",e)}return null}();return e||(e=function(e){if(!o.useCookies)return null;try{const t=e+"=",o=document.cookie.split(";");for(let e=0;e<o.length;e++){let n=o[e];for(;" "===n.charAt(0);)n=n.substring(1,n.length);if(0===n.indexOf(t)){const e=n.substring(t.length,n.length),o=JSON.parse(decodeURIComponent(e));return console.log("[Redacto] üç™ Consent loaded from cookie:",o),o}}}catch(e){console.warn("[Redacto] ‚ö†Ô∏è Failed to load from cookie:",e)}return null}(o.cookieName)),e}function s(){try{const e=document.querySelectorAll('script[src*="redacto"]');for(const t of e){const e=t.src;if(e&&e.includes("redacto")){const t=new URL(e),n=t.searchParams.get("domain"),c=t.searchParams.get("organisation_uuid"),r=t.searchParams.get("workspace_uuid");return n&&(o.domainUrl=n),c&&(o.organisationUuid=c),r&&(o.workspaceUuid=r),console.log("[Redacto] üîó Parsed script URL:",{domain:o.domainUrl,organisationUuid:o.organisationUuid,workspaceUuid:o.workspaceUuid}),!0}}}catch(e){console.warn("[Redacto] ‚ö†Ô∏è Failed to parse script URL:",e)}return!1}function a(){return"session_"+Math.random().toString(36).substr(2,9)+"_"+Date.now()}function i(){let e=localStorage.getItem("redacto_user_id");return e||(e="user_"+Math.random().toString(36).substr(2,9)+"_"+Date.now(),localStorage.setItem("redacto_user_id",e)),e}async function l(e){if(!o.apiEnabled||!o.organisationUuid||!o.workspaceUuid)return console.log("[Redacto] üì° API disabled or missing configuration"),!1;try{const t=a(),n=i(),c={session_id:t,user_id:n,domain_url:o.domainUrl||window.location.origin,consent_categories:e,consent_status:"granted",consent_version:"0.0.1",consent_method:"explicit",user_agent:navigator.userAgent,biometric_consent:!1,expires_at:new Date(Date.now()+24*o.cookieExpiryDays*60*60*1e3).toISOString()},r=`https://api.redacto.tech/consent/public/organisations/${o.organisationUuid}/workspaces/${o.workspaceUuid}/cookie-consent/records`;console.log("[Redacto] üì° Sending consent to API:",{url:r,body:c});const s=await fetch(r,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(c)});if(s.ok){const e=await s.json();return console.log("[Redacto] ‚úÖ Consent recorded successfully:",e),function(){const e=document.createElement("div");e.style.cssText="\n      position: fixed;\n      top: 20px;\n      right: 20px;\n      background: #4CAF50;\n      color: white;\n      padding: 12px 20px;\n      border-radius: 4px;\n      box-shadow: 0 2px 10px rgba(0,0,0,0.2);\n      z-index: 10000;\n      font-family: Arial, sans-serif;\n      font-size: 14px;\n      max-width: 300px;\n    ",e.textContent="‚úÖ Consent recorded successfully",document.body.appendChild(e),setTimeout(()=>{e.parentNode&&e.parentNode.removeChild(e)},3e3)}(),!0}return console.error("[Redacto] ‚ùå API request failed:",s.status,s.statusText),!1}catch(e){return console.error("[Redacto] ‚ùå API request error:",e),!1}}function d(t){if(!t)return null;for(const[o,n]of Object.entries(e))for(const e of n.patterns)if(e.test(t))return{serviceKey:o,category:n.category};return null}function u(t){if(!t)return null;for(const[o,n]of Object.entries(e))if(n.inlinePatterns)for(const e of n.inlinePatterns)if(e.test(t))return{serviceKey:o,category:n.category};return null}function g(e,t=""){const o=d(e),c=u(t),r=o||c;if(!r)return!1;const s=n.consent[r.category];return console.log("[Redacto] Should block check:",{url:e||"(inline)",content:t?t.substring(0,50)+"...":"",serviceKey:r.serviceKey,category:r.category,hasConsent:s,willBlock:!s}),!s}function p(t,o){const c=t.innerHTML||t.textContent||"",r={src:t.src,innerHTML:c,type:t.type,async:t.async,defer:t.defer,charset:t.charset,serviceKey:o.serviceKey,category:o.category};t.src?(n.blockedScripts.push(r),console.log("[Redacto] üõ°Ô∏è Blocked external script:",t.src,"‚Üí",e[o.serviceKey].name,`(${o.category})`)):c&&(n.blockedInlineScripts.push(r),console.log("[Redacto] üõ°Ô∏è Blocked inline script:",c.substring(0,50)+"...","‚Üí",e[o.serviceKey].name,`(${o.category})`))}function y(e){if(e.hasAttribute("data-redacto-blocked"))return console.log("[Redacto] Script already blocked, skipping"),!1;if(e.src&&e.src.includes("redacto"))return console.log("[Redacto] Skipping Redacto's own script"),!1;const t=e.innerHTML||e.textContent||"",o=e.src;if(console.log("[Redacto] Checking script:",{src:o,hasContent:!!t}),g(o,t)){const n=d(o)||u(t);console.log("[Redacto] ‚ö†Ô∏è BLOCKING SCRIPT:",{src:o||"inline",service:n.serviceKey,category:n.category}),t&&t.trim()&&e.setAttribute("data-original-content",t),o&&e.setAttribute("data-original-src",o);const c=e.type||"text/javascript";return e.setAttribute("data-original-type",c),e.type="text/plain",e.setAttribute("data-redacto-blocked",n.category),e.setAttribute("data-redacto-service",n.serviceKey),t&&t.trim()&&(e.textContent=""),o&&e.removeAttribute("src"),p(e,n),document.dispatchEvent(new CustomEvent("redacto:blocked",{detail:{type:o?"external":"inline",url:o,service:n.serviceKey,category:n.category}})),!0}return console.log("[Redacto] ‚úì Script allowed (not a tracked service)"),!1}function m(){const e=document.querySelectorAll("script");let t=0;console.log(`[Redacto] Scanning ${e.length} scripts...`),e.forEach((o,n)=>{console.log(`[Redacto] Checking script ${n+1}/${e.length}`),y(o)&&t++}),console.log(`[Redacto] üìä Scanned ${e.length} scripts, blocked ${t}`)}function f(t){if(t.hasAttribute("data-redacto-blocked"))return!1;const o=t.getAttribute("src")||t.src;if(!o)return!1;const c=d(o);return!(!c||n.consent[c.category])&&(t.setAttribute("data-redacto-src",o),t.removeAttribute("src"),t.src="",t.setAttribute("data-redacto-blocked",c.category),t.setAttribute("data-redacto-service",c.serviceKey),console.log("[Redacto] üõ°Ô∏è Blocked iframe:",o,"‚Üí",e[c.serviceKey].name,`(${c.category})`),!0)}function b(){const e=document.querySelectorAll("iframe");let t=0;e.forEach(e=>{f(e)&&t++}),console.log(`[Redacto] üìä Scanned ${e.length} iframes, blocked ${t}`)}function v(e){console.log("[Redacto] üîì Unblocking category:",e);n.blockedScripts.filter(t=>t.category===e).forEach(e=>{const t=document.createElement("script");e.src&&(t.src=e.src),t.async=e.async||!1,t.defer=e.defer||!1,e.charset&&(t.charset=e.charset),document.head.appendChild(t),console.log("[Redacto] ‚úÖ Loaded external script:",e.src)});n.blockedInlineScripts.filter(t=>t.category===e).forEach(t=>{const o=document.createElement("script");o.textContent=t.innerHTML,document.head.appendChild(o),console.log("[Redacto] ‚úÖ Executed inline script for:",e)});document.querySelectorAll(`script[data-redacto-blocked="${e}"]`).forEach(e=>{const t=document.createElement("script"),o=e.getAttribute("data-original-src");o&&(t.src=o);const n=e.getAttribute("data-original-content");n&&(t.textContent=n);const c=e.getAttribute("data-original-type");c&&(t.type=c),t.async=e.async,t.defer=e.defer,e.parentNode.insertBefore(t,e),e.remove(),console.log("[Redacto] ‚úÖ Restored blocked script from DOM")});document.querySelectorAll(`iframe[data-redacto-blocked="${e}"]`).forEach(e=>{const t=e.getAttribute("data-redacto-src");t&&(e.src=t,e.removeAttribute("data-redacto-blocked"),e.removeAttribute("data-redacto-src"),console.log("[Redacto] ‚úÖ Unblocked iframe:",t))})}function k(e){const t={...n.consent};n.consent={...n.consent,...e},c(n.consent),l(n.consent);for(const[o,n]of Object.entries(e))n&&!t[o]&&v(o);console.log("[Redacto] üìã Consent updated:",n.consent)}function h(){const e=document.getElementById("redacto"),t=document.querySelector(".redacto-backdrop");e&&e.classList.remove("show"),t&&t.classList.remove("show"),document.body.classList.remove("redacto-modal-open"),setTimeout(()=>{e?.parentElement?.remove()},300)}function R(){console.log("[Redacto] ‚úÖ Accept All clicked");const e={strictly_necessary:!0};Object.keys(t).forEach(t=>{e[t]=!0}),k(e),h(),setTimeout(()=>{document.dispatchEvent(new CustomEvent("redacto:accept",{detail:n.consent}))},100)}function S(){console.log("[Redacto] ‚úÖ Accept Only Necessary clicked");const e={strictly_necessary:!0};Object.keys(t).forEach(t=>{e[t]=!1}),k(e),h(),setTimeout(()=>{document.dispatchEvent(new CustomEvent("redacto:accept",{detail:n.consent}))},100)}function A(){console.log("[Redacto] ‚úÖ Accept Selected clicked");const e={strictly_necessary:!0};Object.keys(t).forEach(t=>{const o=document.querySelector(`.redacto-toggle[data-category="${t}"]`),n=o&&o.classList.contains("active");e[t]=n,console.log(`[Redacto] Category ${t}: ${n?"enabled":"disabled"}`)}),k(e),h(),setTimeout(()=>{document.dispatchEvent(new CustomEvent("redacto:accept",{detail:n.consent}))},100)}function C(e){const t=e.currentTarget;if(t.classList.contains("disabled"))return;const o=t.getAttribute("data-category"),c=t.classList.contains("active");t.classList.toggle("active");const r=!c;console.log(`[Redacto] üîÑ Toggle ${o}: ${r}`),n.consent[o]=r}function w(){console.log("[Redacto] üéØ Personalize Cookies clicked");const e=document.getElementById("redacto-services-list");e&&(e.style.display="block");const t=document.getElementById("redacto-accept-all");t&&(t.style.display="none");const o=document.getElementById("redacto-personalize");o&&(o.style.display="none");const n=document.getElementById("redacto-accept-selected");n&&(n.style.display="inline-block")}function E(){const o=document.createElement("div");o.innerHTML=`\n        <div class="redacto-backdrop show"></div>\n        <div id="redacto" class="show">\n          <div class="redacto-modal-content">\n            <div class="redacto-modal-header">\n              <h2 class="redacto-modal-title">Cookie Consent</h2>\n            </div>\n            \n            <div class="redacto-modal-body">\n              <p class="redacto-description">\n                We use cookies to enhance your browsing experience, serve personalized content, and analyze our traffic. \n                By clicking "Accept All", you consent to our use of cookies.\n              </p>\n              \n              <div class="redacto-services-list" id="redacto-services-list" style="display: none;">\n                <div class="redacto-service-item">\n                  <div class="redacto-service-info">\n                    <div class="redacto-service-name">Essential Cookies</div>\n                    <div class="redacto-service-description">Required for the website to function properly</div>\n                  </div>\n                  <div class="redacto-service-toggle">\n                    <div class="redacto-toggle active disabled">\n                      <div class="redacto-toggle-handle"></div>\n                    </div>\n                  </div>\n                </div>\n                ${Object.entries(t).map(([t,o])=>{const c=o.required,r=n.consent[t],s=o.services.map(t=>e[t].name).join(", ");return`\n          <div class="redacto-service-item" data-category="${t}">\n            <div class="redacto-service-info">\n              <div class="redacto-service-name">${o.name}</div>\n              <div class="redacto-service-description">${o.description}</div>\n              <div class="redacto-service-list" style="font-size: 0.75rem; color: #666; margin-top: 4px;">\n                Includes: ${s}\n              </div>\n            </div>\n            <div class="redacto-service-toggle">\n              <div class="redacto-toggle ${r?"active":""} ${c?"disabled":""}" data-category="${t}">\n                <div class="redacto-toggle-handle"></div>\n              </div>\n            </div>\n          </div>\n        `}).join("")}\n              </div>\n            </div>\n            \n            <div class="redacto-modal-footer">\n              <button class="redacto-button redacto-button-primary" id="redacto-accept-all">Accept All</button>\n              <button class="redacto-button redacto-button-personalize" id="redacto-personalize">Personalize Cookies</button>\n              <button class="redacto-button redacto-button-selected" id="redacto-accept-selected" style="display: none;">Accept Selected</button>\n              <button class="redacto-button redacto-button-secondary">Accept Only Necessary</button>\n            </div>\n          </div>\n        </div>\n      `,document.body.appendChild(o),document.body.classList.add("redacto-modal-open"),document.querySelector(".redacto-button-primary")?.addEventListener("click",R),document.querySelector(".redacto-button-selected")?.addEventListener("click",A),document.querySelector(".redacto-button-secondary")?.addEventListener("click",S),document.querySelector(".redacto-backdrop")?.addEventListener("click",h),document.getElementById("redacto-personalize")?.addEventListener("click",w),document.querySelectorAll(".redacto-toggle").forEach(e=>{e.classList.contains("disabled")||e.addEventListener("click",C)})}window.Redacto={acceptAll:function(){const e={strictly_necessary:!0};Object.keys(t).forEach(t=>{e[t]=!0}),k(e)},acceptOnlyNecessary:function(){const e={strictly_necessary:!0};Object.keys(t).forEach(t=>{e[t]=!1}),k(e)},acceptSelected:function(){const e={strictly_necessary:!0};Object.keys(t).forEach(t=>{const o=document.querySelector(`.redacto-toggle[data-category="${t}"]`),n=o&&o.classList.contains("active");e[t]=n}),k(e)},updateConsent:function(e){k(e)},getConsent:function(){return{...n.consent}},getState:function(){return{consent:{...n.consent},blockedScripts:[...n.blockedScripts],blockedInlineScripts:[...n.blockedInlineScripts]}},getServices:function(){return e},getCategories:function(){return t},saveConsent:function(e){c(e)},loadConsent:function(){return r()},clearConsent:function(){try{o.useLocalStorage&&localStorage.removeItem(o.storageKey),o.useCookies&&(document.cookie=`${o.cookieName}=;expires=Thu, 01 Jan 1970 00:00:00 UTC;path=/;`),console.log("[Redacto] üóëÔ∏è Consent cleared from storage")}catch(e){console.warn("[Redacto] ‚ö†Ô∏è Failed to clear consent:",e)}},getConfig:function(){return{...o}},setConfig:function(e){Object.assign(o,e),console.log("[Redacto] ‚öôÔ∏è Configuration updated:",o)},sendConsentToApi:function(e){return l(e)},parseScriptUrl:function(){return s()},generateSessionId:function(){return a()},generateUserId:function(){return i()}},console.log("[Redacto] Script loaded, starting initialization..."),function(){if(n.initialized)return;console.log("[Redacto] üöÄ Initializing..."),console.log("[Redacto] Active services:",Object.keys(e)),s();const t=r();t?(console.log("[Redacto] üìñ Found saved consent:",t),n.consent={...n.consent,...t}):console.log("[Redacto] üìù No saved consent found, will show popup"),console.log("[Redacto] Current consent state:",n.consent),function(){const e=document.createElement.bind(document);document.createElement=function(t){const o=e(t);if("script"===t.toLowerCase()){console.log("[Redacto] Script element created via createElement");const e=o.setAttribute.bind(o);o.setAttribute=function(t,o){if("src"===t.toLowerCase()&&(console.log("[Redacto] setAttribute('src') called with:",o),g(o))){console.log("[Redacto] üõ°Ô∏è Blocked dynamic script (setAttribute):",o);const t=d(o);return e("data-redacto-blocked",t.category),e("data-redacto-service",t.serviceKey),e("type","text/plain"),e("data-original-src",o),void p({src:o},t)}return e(t,o)};let t="";Object.defineProperty(o,"src",{set:function(n){if(console.log("[Redacto] src property set to:",n),g(n)){console.log("[Redacto] üõ°Ô∏è Blocked dynamic script (property):",n);const e=d(n);return o.setAttribute("data-redacto-blocked",e.category),o.setAttribute("data-redacto-service",e.serviceKey),o.type="text/plain",o.setAttribute("data-original-src",n),p({src:n},e),void(t=n)}t=n,e("src",n)},get:function(){return t}});const n=Object.getOwnPropertyDescriptor(Node.prototype,"textContent"),c=Object.getOwnPropertyDescriptor(Element.prototype,"innerHTML");Object.defineProperty(o,"textContent",{set:function(e){if(e&&g("",e)){console.log("[Redacto] üõ°Ô∏è Blocked inline script (textContent):",e.substring(0,50)+"...");const t=u(e);return o.setAttribute("data-redacto-blocked",t.category),o.setAttribute("data-redacto-service",t.serviceKey),o.setAttribute("data-original-content",e),o.type="text/plain",void p({innerHTML:e},t)}n.set.call(o,e)},get:function(){return n.get.call(o)}}),Object.defineProperty(o,"innerHTML",{set:function(e){if(e&&g("",e)){console.log("[Redacto] üõ°Ô∏è Blocked inline script (innerHTML):",e.substring(0,50)+"...");const t=u(e);return o.setAttribute("data-redacto-blocked",t.category),o.setAttribute("data-redacto-service",t.serviceKey),o.setAttribute("data-original-content",e),o.type="text/plain",void p({innerHTML:e},t)}c.set.call(o,e)},get:function(){return c.get.call(o)}})}return o},console.log("[Redacto] ‚úì Script creation interceptor installed")}(),function(){for(const t of Object.values(e))t.globals&&t.globals.forEach(e=>{try{delete window[e]}catch(t){window[e]=void 0}});console.log("[Redacto] ‚úì Cleaned up tracking globals")}(),m(),b(),n.observer||(n.observer=new MutationObserver(e=>{e.forEach(e=>{e.addedNodes.forEach(e=>{"SCRIPT"===e.nodeName&&(console.log("[Redacto] New script detected via MutationObserver"),y(e)),"IFRAME"===e.nodeName&&f(e),1===e.nodeType&&(e.querySelectorAll("script").forEach(e=>{console.log("[Redacto] New script in added element"),y(e)}),e.querySelectorAll("iframe").forEach(e=>f(e)))}),"attributes"===e.type&&"IFRAME"===e.target.nodeName&&"src"===e.attributeName&&f(e.target)})}),n.observer.observe(document.documentElement,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["src"]}),console.log("[Redacto] ‚úì Mutation observer started")),function(){const e=document.createElement("link");e.rel="stylesheet",e.href="redacto/redacto.css",e.type="text/css",document.head.appendChild(e)}(),t?(console.log("[Redacto] ‚úÖ Applying saved consent preferences"),Object.keys(n.consent).forEach(e=>{n.consent[e]&&"strictly_necessary"!==e&&v(e)})):setTimeout(()=>{E()},500),n.initialized=!0,document.dispatchEvent(new CustomEvent("redacto:initialized")),console.log("[Redacto] ‚úÖ Initialization complete"),console.log("[Redacto] üìä Stats:",{blockedScripts:n.blockedScripts.length,blockedInlineScripts:n.blockedInlineScripts.length,consent:n.consent})}(),"loading"===document.readyState&&document.addEventListener("DOMContentLoaded",function(){console.log("[Redacto] üîÑ DOMContentLoaded - Re-scanning..."),m(),b()})}();